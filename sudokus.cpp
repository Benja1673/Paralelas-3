#include <iostream>
#include <vector>
#include <cmath>  // Para sqrt, necesario para subcuadros de mayor tamaño
#include <chrono> // Para medir el tiempo
#include <thread>
#include <mutex>
#include <queue>
#include <future>
#include <omp.h>
#include <random>
#include <iomanip> // Para formatear la salida

#include "sudokus.h"

// Función para inicializar un tablero con memoria dinámica a partir de un vector
int** initializeBoard(const std::vector<std::vector<int>>& initialBoard) {
    int size = initialBoard.size();
    int** board = new int* [size];
    for (int i = 0; i < size; i++) {
        board[i] = new int[size];
        for (int j = 0; j < size; j++) {
            board[i][j] = initialBoard[i][j];
        }
    }
    return board;
}

// Función para liberar la memoria dinámica del tablero
void freeBoard(int** board, int size) {
    for (int i = 0; i < size; i++) {
        delete[] board[i];
    }
    delete[] board;
}
// Función para imprimir el tablero de Sudoku
void printBoard(int** board, int size) {
    std::cout << "{" << std::endl;
    std::cout << "\t\"board\": [" << std::endl;
    for (int i = 0; i < size; i++) {
        std::cout << "\t\t[";
        for (int j = 0; j < size; j++) {
            std::cout << board[i][j];
            if (j != size - 1) std::cout << ", ";
        }
        std::cout << "]";
        if (i != size - 1) std::cout << ",";
        std::cout << std::endl;
    }
    std::cout << "\t]" << std::endl;
    std::cout << "}" << std::endl;
}


// Tablero de Sudoku 25x25 de dificultad media como ejemplo de entrada
std::vector<std::vector<int>> board25x25_dificultad_media = {
    {18, 6, 22, 0, 10, 25, 0, 12, 0, 8, 16, 13, 0, 0, 7, 3, 23, 15, 0, 14, 24, 5, 0, 4, 1},
    {3, 13, 0, 23, 4, 0, 21, 0, 14, 20, 0, 12, 8, 10, 24, 5, 0, 18, 1, 0, 6, 25, 2, 19, 17},
    {0, 25, 1, 0, 24, 0, 11, 18, 0, 19, 20, 17, 15, 0, 5, 16, 7, 0, 2, 4, 8, 0, 10, 23, 0},
    {14, 0, 15, 8, 0, 3, 0, 13, 0, 1, 22, 6, 0, 23, 0, 25, 0, 19, 10, 12, 0, 7, 9, 0, 21},
    {7, 0, 11, 19, 17, 2, 0, 16, 0, 23, 0, 18, 1, 3, 4, 0, 9, 0, 8, 21, 20, 0, 15, 14, 0},
    {0, 9, 8, 3, 0, 13, 19, 0, 5, 0, 6, 22, 0, 4, 12, 18, 0, 7, 0, 10, 17, 0, 20, 11, 15},
    {4, 14, 24, 0, 2, 1, 0, 0, 0, 15, 23, 0, 10, 8, 0, 13, 22, 0, 19, 5, 25, 9, 3, 0, 6},
    {15, 0, 7, 18, 13, 0, 0, 6, 0, 0, 2, 9, 5, 1, 0, 23, 14, 20, 0, 3, 0, 24, 21, 8, 0},
    {0, 22, 0, 11, 20, 0, 23, 0, 8, 3, 14, 0, 16, 15, 25, 9, 0, 2, 6, 0, 4, 13, 0, 5, 12},
    {25, 0, 0, 5, 6, 22, 0, 21, 11, 9, 0, 20, 13, 7, 18, 0, 8, 17, 4, 24, 2, 0, 1, 0, 19},
    {17, 0, 0, 4, 0, 0, 1, 11, 0, 0, 5, 24, 3, 19, 22, 0, 13, 0, 16, 0, 10, 8, 7, 25, 9},
    {0, 11, 10, 0, 15, 0, 8, 24, 18, 0, 7, 0, 12, 0, 13, 4, 20, 0, 3, 2, 1, 0, 5, 17, 14},
    {5, 1, 0, 0, 12, 4, 0, 2, 19, 13, 0, 25, 0, 9, 8, 0, 10, 22, 0, 7, 0, 6, 24, 0, 16},
    {22, 16, 0, 0, 8, 17, 15, 0, 0, 10, 1, 0, 0, 6, 0, 24, 12, 5, 0, 25, 11, 0, 19, 13, 23},
    {0, 21, 0, 6, 23, 0, 0, 25, 0, 5, 0, 15, 18, 20, 10, 0, 1, 11, 9, 0, 3, 0, 22, 12, 4},
    {2, 0, 19, 0, 1, 21, 0, 8, 20, 0, 10, 5, 0, 0, 9, 22, 18, 16, 15, 13, 0, 11, 23, 3, 24},
    {0, 3, 6, 0, 7, 5, 9, 0, 2, 0, 8, 14, 4, 0, 19, 20, 0, 10, 17, 0, 12, 0, 13, 15, 0},
    {0, 5, 23, 0, 9, 15, 0, 0, 4, 0, 12, 16, 7, 0, 20, 2, 3, 0, 24, 0, 22, 19, 17, 0, 8},
    {11, 0, 25, 15, 14, 0, 0, 0, 0, 18, 0, 2, 0, 22, 3, 0, 4, 1, 0, 6, 9, 10, 16, 0, 5},
    {20, 17, 0, 22, 16, 0, 3, 10, 12, 11, 0, 1, 0, 24, 15, 19, 0, 9, 21, 8, 7, 4, 0, 0, 25},
    {12, 0, 0, 0, 19, 10, 22, 0, 3, 6, 0, 8, 14, 2, 16, 7, 24, 0, 13, 20, 21, 0, 25, 0, 11},
    {6, 0, 14, 0, 22, 11, 2, 9, 0, 7, 0, 3, 0, 5, 23, 21, 19, 8, 0, 17, 0, 15, 4, 1, 0},
    {8, 10, 4, 0, 0, 20, 12, 5, 0, 24, 19, 0, 9, 0, 21, 11, 15, 0, 22, 16, 0, 18, 0, 6, 2},
    {16, 0, 21, 13, 0, 18, 25, 17, 0, 0, 24, 10, 20, 0, 0, 1, 0, 4, 5, 9, 0, 3, 8, 22, 7},
    {0, 7, 2, 9, 0, 8, 13, 19, 0, 21, 0, 0, 22, 0, 1, 10, 6, 0, 14, 18, 5, 16, 12, 0, 20}
};



// Tablero de Sudoku 16x16 de dificultad media como ejemplo de entrada
std::vector<std::vector<int>> board16x16_dificultad_media = {
    {12, 14,  4,  5, 13,  6,  1,  9,  0,  7, 10,  2,  0,  0, 11, 15},
    {15,  6, 10,  1,  2, 11,  5, 14,  8,  3,  0,  0, 12,  7,  4, 16},
    { 9,  3,  0,  8,  0,  7, 15,  0, 11, 14,  5,  1,  0, 13,  6, 10},
    { 7,  0, 11, 13,  8, 16,  0, 10,  0,  4,  0, 12,  9,  0,  5, 14},
    { 0, 16,  0,  3, 10, 13,  8, 15,  0, 11,  7,  5,  0,  6,  2,  9},
    {13,  7,  0,  9,  1,  5,  2, 11,  3,  0, 14,  0, 15,  0, 12,  8},
    { 8,  5, 14,  0,  0,  9,  0, 12,  0, 13,  0,  0,  7, 10,  1,  3},
    { 1, 10,  2,  0, 16,  0,  7,  3,  0,  9,  8,  6,  0,  4,  0,  5},
    { 0, 13,  0, 16,  7,  0,  6,  2,  4,  0,  3,  8,  1,  5,  9, 11},
    { 5,  0,  9, 12, 11, 15,  0,  0, 13,  6,  0,  7,  0, 14, 10,  4},
    { 2, 11,  0,  0,  5,  4,  9, 13, 10, 15,  1,  0, 16, 12,  0,  7},
    {10,  8,  7,  4, 14,  3,  0,  1,  9,  0, 11, 16, 13,  0, 15,  6},
    { 3, 15,  5, 10,  0,  0, 13, 16,  0,  2,  0, 11,  6,  8,  0, 12},
    { 0,  4,  8,  0,  9, 12, 11,  7,  5,  1,  0,  0, 10, 15, 14, 13},
    { 6,  9, 13,  0,  0,  2, 14,  5,  0,  8, 12, 10,  0,  0, 16,  1},
    {11,  0,  1, 14,  0,  8, 10,  6,  7, 16,  4, 13,  0,  9,  3,  2}
};




// Tablero de Sudoku 9x9 de dificultad media como ejemplo de entrada
std::vector<std::vector<int>> board9x9_dificultad_media = {
    {5, 3, 0, 6, 7, 0, 9, 0, 2},
    {6, 0, 2, 0, 9, 5, 0, 4, 0},
    {0, 9, 8, 0, 0, 2, 5, 6, 0},
    {8, 0, 9, 7, 0, 1, 0, 2, 3},
    {4, 2, 0, 0, 5, 0, 7, 9, 0},
    {0, 1, 3, 9, 2, 0, 8, 5, 6},
    {9, 0, 1, 0, 3, 7, 2, 0, 4},
    {0, 8, 7, 0, 1, 9, 0, 3, 0},
    {3, 0, 0, 2, 0, 6, 1, 7, 9}
};